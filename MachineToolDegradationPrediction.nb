(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11094,        283]
NotebookOptionsPosition[      9998,        257]
NotebookOutlinePosition[     10421,        274]
CellTagsIndexPosition[     10378,        271]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["OpenIE \:5f00\:6e90\:667a\:6167\:5de5\:7a0b", "Title",
 CellChangeTimes->{{3.9021962210729694`*^9, 
  3.902196249236627*^9}},ExpressionUUID->"92fd93a5-3d54-4da1-a100-\
381a5e035690"],

Cell["\:52a0\:5de5\:4e2d\:5fc3\:5200\:5177\:78e8\:635f\:91cf\:9884\:6d4b\:53ca\
\:5176\:5de5\:4e1a\:5e94\:7528", "Subtitle",
 CellChangeTimes->{{3.902196279569437*^9, 
  3.9021963064705114`*^9}},ExpressionUUID->"bf1aebb1-1f5b-4c55-90b2-\
4783ae71c5d5"],

Cell[CellGroupData[{

Cell["Section 1 Import Data from \[OpenCurlyDoubleQuote]*.csv\
\[CloseCurlyDoubleQuote] file", "Section",
 CellChangeTimes->{{3.90219719459752*^9, 3.9021972063954363`*^9}, {
  3.9022044448992968`*^9, 
  3.9022044733486404`*^9}},ExpressionUUID->"08b83838-5849-401c-9d75-\
d6d3412dbbdc"],

Cell["\<\
Define a function for read \[OpenCurlyDoubleQuote]*.csv\
\[CloseCurlyDoubleQuote] file, input the file name and return as data.\
\>", "Text",
 CellChangeTimes->{{3.902268316179364*^9, 
  3.902268355103919*^9}},ExpressionUUID->"6311fa63-39c4-4a6c-8976-\
558d3a651bb2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"readMachineSignal", "[", "csvFileName_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "(*", "\:83b7\:53d6\:5f53\:524dNotebook\:6587\:4ef6\:6240\:5728\:7684\
\:6587\:4ef6\:5939\:5730\:5740", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"currentDirectory", "=", 
      RowBox[{"NotebookDirectory", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "(*", "\:6784\:5efaCSV\:548cDAT\:6587\:4ef6\:7684\:5b8c\:6574\:8def\:5f84\
", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"csvFilePath", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "currentDirectory", ",", "\"\<machineData\>\"", ",", "csvFileName"}], 
        "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"csvFilePath", ",", "\"\<CSV\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "data"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9022618056400623`*^9, 3.9022618185086317`*^9}, {
   3.9022620575066547`*^9, 3.902262091885028*^9}, {3.902262236460253*^9, 
   3.902262269240074*^9}, {3.9022638622648287`*^9, 3.9022639514122005`*^9}, {
   3.902263988498618*^9, 3.9022641842335515`*^9}, {3.9022642254434085`*^9, 
   3.9022642514956055`*^9}, {3.9022642825894985`*^9, 
   3.9022642850927916`*^9}, {3.902264344986722*^9, 3.902264359994604*^9}, {
   3.9022644276825247`*^9, 3.902264428681924*^9}, 3.902264458899445*^9, {
   3.9022645384899015`*^9, 3.9022645453286552`*^9}, {3.9022646484155912`*^9, 
   3.9022646489391804`*^9}, 3.9022654747988243`*^9, {3.902266227220583*^9, 
   3.902266227666108*^9}, {3.9022662792991705`*^9, 3.9022662795148854`*^9}, {
   3.9022683639172735`*^9, 
   3.9022683671242266`*^9}},ExpressionUUID->"d647cd1b-a4de-44ee-8be6-\
3664db6d0893"],

Cell["Plot the data with 3 rows and 2 colons graph", "Text",
 CellChangeTimes->{{3.9022683738859873`*^9, 
  3.902268425152521*^9}},ExpressionUUID->"9cba0299-d351-4bfc-8c33-\
4443eb78ca11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotMachineSignal", "[", "data_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"smcAC", "=", 
      RowBox[{"Rest", "[", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"smcDC", "=", 
      RowBox[{"Rest", "[", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vibTable", "=", 
      RowBox[{"Rest", "[", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vibSpindle", "=", 
      RowBox[{"Rest", "[", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "5"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AETable", "=", 
      RowBox[{"Rest", "[", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "6"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AESpindle", "=", 
      RowBox[{"Rest", "[", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "7"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"smcACPlot", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"smcAC", ",", 
        RowBox[{"PlotStyle", "->", "Red"}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameLabel", "->", 
         RowBox[{"{", 
          RowBox[{
          "\"\<AC spindle motor current\>\"", ",", "\"\<current\>\""}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"smcDCPlot", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"smcDC", ",", 
        RowBox[{"PlotStyle", "->", "Green"}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameLabel", "->", 
         RowBox[{"{", 
          RowBox[{
          "\"\<DC spindle motor current\>\"", ",", "\"\<current\>\""}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vibTablePlot", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"vibTable", ",", 
        RowBox[{"PlotStyle", "->", "Blue"}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameLabel", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<Table vibration\>\"", ",", "\"\<vibration\>\""}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vibSpindlePlot", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"vibSpindle", ",", 
        RowBox[{"PlotStyle", "->", "Purple"}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameLabel", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<Spindle vibration\>\"", ",", "\"\<vibration\>\""}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AETablePlot", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"AETable", ",", 
        RowBox[{"PlotStyle", "->", "Orange"}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameLabel", "->", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Acoustic emission at table\>\"", ",", 
           "\"\<acoustic emission\>\""}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AESpindlePlot", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"AESpindle", ",", 
        RowBox[{"PlotStyle", "->", "Cyan"}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameLabel", "->", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Acoustic emission at spindle\>\"", ",", 
           "\"\<acoustic emission\>\""}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GraphicsGrid", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"smcACPlot", ",", "smcDCPlot"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"vibTablePlot", ",", "vibSpindlePlot"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"AETablePlot", ",", "AESpindlePlot"}], "}"}]}], "}"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9022652845129814`*^9, 3.9022653536761227`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"70c4e031-52bd-4500-b7a1-71daabd97c1e"],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<=", "167"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"inputFileName", "=", 
     RowBox[{
      RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.csv\>\""}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"data", "=", 
     RowBox[{"readMachineSignal", "[", "inputFileName", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"plot", "=", 
     RowBox[{"plotMachineSignal", "[", "data", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"outputFileName", "=", 
     RowBox[{
      RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.pdf\>\""}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<machineData\>\"", 
         ",", "\"\<SignalPic\>\"", ",", "outputFileName"}], "}"}], "]"}], ",",
       "plot"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Already output No.\>\"", "<>", 
      RowBox[{"ToString", "[", "i", "]"}], "<>", 
      "\"\< csv file Signal Diagram\>\""}], "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.902265482999652*^9, 3.9022655132742395`*^9}, {
   3.902266362546195*^9, 3.9022663979725056`*^9}, {3.9022664373667555`*^9, 
   3.902266646974101*^9}, 3.9022667106713123`*^9, {3.902266828849697*^9, 
   3.9022668868587856`*^9}, {3.9022669353064604`*^9, 
   3.9022669610307207`*^9}, {3.9022672100700893`*^9, 
   3.9022672201909037`*^9}, {3.902267819821743*^9, 3.902267902336158*^9}, {
   3.9022679344565563`*^9, 3.902267934787964*^9}, {3.9022681412808895`*^9, 
   3.9022681476474686`*^9}},ExpressionUUID->"91a3d250-e71f-49b1-886e-\
9ba090ba0631"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{783.75, 680.25},
WindowMargins->{{Automatic, -1023}, {Automatic, 25.5}},
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (2023\:5e747\:670824\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"046d0ae3-a27d-4f40-a08b-ee505195b36f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 188, 3, 98, "Title",ExpressionUUID->"92fd93a5-3d54-4da1-a100-381a5e035690"],
Cell[771, 27, 252, 4, 53, "Subtitle",ExpressionUUID->"bf1aebb1-1f5b-4c55-90b2-4783ae71c5d5"],
Cell[CellGroupData[{
Cell[1048, 35, 285, 5, 67, "Section",ExpressionUUID->"08b83838-5849-401c-9d75-d6d3412dbbdc"],
Cell[1336, 42, 277, 6, 35, "Text",ExpressionUUID->"6311fa63-39c4-4a6c-8976-558d3a651bb2"],
Cell[1616, 50, 1899, 38, 232, "Input",ExpressionUUID->"d647cd1b-a4de-44ee-8be6-3664db6d0893"],
Cell[3518, 90, 188, 3, 35, "Text",ExpressionUUID->"9cba0299-d351-4bfc-8c33-4443eb78ca11"],
Cell[3709, 95, 4413, 114, 754, "Input",ExpressionUUID->"70c4e031-52bd-4500-b7a1-71daabd97c1e"],
Cell[8125, 211, 1845, 42, 262, "Input",ExpressionUUID->"91a3d250-e71f-49b1-886e-9ba090ba0631"]
}, Open  ]]
}, Open  ]]
}
]
*)

